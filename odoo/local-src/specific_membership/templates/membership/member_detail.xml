<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="partner" inherit_id="website_membership.partner" name="Fluxdock partner detail override">
        <xpath expr="//div[@id='wrap']" position="attributes">
            <attribute name="class" add="opt_dark_grid_bg member-detail" separator=" " />
        </xpath>
        <xpath expr="//div[contains(@class,'container')]"  position="attributes">
            <attribute name="class">container-fluid</attribute>
        </xpath>
    </template>

    <template id="member_item_tags" name="Fluxdock member tags template">
        <div class="item-tags">
            <strong>Industry:</strong>
            <span class="tag-value">
                <t t-foreach="item.category_id" t-as="one_tag">
                    <t t-esc="one_tag.name + ('' if one_tag_last else ', ')"/>
                </t>
            </span>
        </div>
        <div class="item-tags">
            <strong>Expertise:</strong>
            <span class="tag-value">
                <t t-foreach="item.expertise_ids" t-as="one_tag">
                    <t t-esc="one_tag.name + ('' if one_tag_last else ', ')"/>
                </t>
            </span>
        </div>
    </template>

    <template id="fluxdock_partner_detail" name="Fluxdock partner details" inherit_id="website_partner.partner_detail">
      <xpath expr="//h1[@id='partner_name']" position="replace">
        <h1 class="hide col-md-12 text-center" id="partner_name" t-field="partner.display_name" />
      </xpath>
      <xpath expr="//h1[@id='partner_name']" position="after">
        <section class="top-spacer-small opt_dark_grid_bg"></section>
      </xpath>
      <xpath expr="//div[@class='col-md-4']" position="replace">

        <t t-if="partner_user">
            <t t-set="carousel_items" t-value="[x for x in partner_user.references_ids if x.image]" />
            <t t-if="carousel_items">
                <div class="container-xxlg">
                    <div class="references-slider">
                        <t t-call="theme_fluxdocs.carousel">
                            <t t-set="carousel_data" t-value='"""{"auto":true, "mode": "fade"}"""' />
                        </t>
                    </div>
                </div>
            </t>
        </t>
        <section class="content member-detail-view white_bg">
          <div class="content-wrap">
            <t t-if="partner.image">
              <div class="row mb32">
                  <div class="col-md-12">
                    <div t-field="partner.image" t-field-options='{"widget": "image", "class": "center-block", "max_width": 200}' />
                  </div>
              </div>
            </t>
            <div class="row">
                <div class="col-md-12">
                    <div class="item-details">
                      <t t-if="not partner.image">
                        <h2 class="item-title member-title" id="partner_name" t-field="partner.display_name" />
                      </t>
                      <t t-if="partner">
                        <div class="item-description" t-field="partner.website_short_description" />
                        <t t-call="specific_membership.member_item_tags">
                            <t t-set="item" t-value="partner" />
                        </t>
                      </t>
                    </div>
                </div>
            </div>
          </div>
          <address class="hide well">
            <div t-field="partner.self" t-field-options='{ "widget": "contact", "fields": ["address", "website", "phone", "fax", "email"] }' />
          </address>
        </section>
        <t t-if="partner">
          <section class="content detail-address member-address white_bg">
              <div class="content-wrap">
                <h2 class="border-bottom">Contact</h2>
                <div class="member-fields">
                  <span t-esc="partner.name" /><br />
                  <span t-esc="partner.street2" /><br />
                  <t t-if="partner.country_id">
                    <span t-esc="partner.country_id.name" />-
                  </t>
                  <span t-esc="partner.zip" /> <span t-esc="partner.city" /><br />
                  <t t-if="partner.phone">t
                    <span t-esc="partner.phone" /><br />
                  </t>
                  <t t-if="partner.fax">f
                    <span t-esc="partner.fax" /><br />
                  </t>
                  <!--  TODO: obfuscate email to prevent SPAMming -->
                  <t t-if="partner.email">
                    <a t-attf-href="mailto:{{ partner.email }}"><t t-esc="partner.email"/></a>
                    <br />
                  </t>
                  <t t-if="partner.website">
                    <a t-att-href="partner.website"><t t-esc="partner.website"/></a>
                  </t>
                </div>
                <div class="member-social-media">
                  <a target="_blank" t-att-href="partner.facebook" t-if="partner.facebook" class="social-media facebook">
                    <i class="fa fa-facebook circled" aria-hidden="true"/>
                  </a>
                  <a target="_blank" t-att-href="partner.twitter" t-if="partner.twitter" class="social-media twitter">
                    <i class="fa fa-twitter circled" aria-hidden="true"></i>
                  </a>
                  <a target="_blank" t-attf-href="skype:#{partner.skype}?userinfo" t-if="partner.skype" class="social-media skype">
                    <i class="fa fa-skype circled" aria-hidden="true"></i>
                  </a>
                </div>
              </div>
          </section>
        </t>
        <t t-if="partner_user and partner_user.references_ids">
            <div class="project-references opt_dark_bg">
                <div class="container-xxlg">
                    <section class="content">
                      <div class="content-wrap">
                        <h2>Reference Projects</h2>
                      </div>
                    </section>
                    <t t-call="theme_fluxdocs.mosaic">
                        <t t-set="mosaic_items" t-value="partner_user.references_ids[:4]" />
                    </t>
                </div>
            </div>
        </t>
      </xpath>
      <xpath expr="//div[@class='col-md-8 mt32']" position="replace">
        <div class="col-md-8 mt32 hide">
          <t t-if="partner">
            <div t-field="partner.website_description" />
            <t groups="base.group_website_publisher">
              <h2 class="css_non_editable_mode_hidden">Short Description for List View</h2>
              <div class="css_non_editable_mode_hidden" t-field="partner.website_short_description" />
            </t>
          </t>
          <t t-raw="right_column or ''" />
        </div>
      </xpath>
    </template>

</odoo>
