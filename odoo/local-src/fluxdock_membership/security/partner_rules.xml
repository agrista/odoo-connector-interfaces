<odoo>

<!-- we must specify "public" group too, because of the rule
`base.res_partner_portal_public_rule` -->
<record model="ir.rule" id="portal_members_visibility">
  <field name="name">Portal and public user can see published members</field>
  <field name="model_id" ref="model_res_partner"/>
  <field name="perm_read" eval="True"/>
  <field name="perm_write" eval="False"/>
  <field name="perm_create" eval="False"/>
  <field name="perm_unlink" eval="False"/>
  <field name="groups" eval="[(4, ref('base.group_portal')),(4, ref('base.group_public'))]"/>
  <field name="domain_force">['&amp;', ('membership_state', 'in', ('free', 'paid', 'invoiced')), ('website_published', '=', True)]</field>
</record>

<record model="ir.rule" id="user_can_edit_partner">
  <field name="name">Portal user can write its partner record</field>
  <field name="model_id" ref="model_res_partner"/>
  <field name="perm_read" eval="False"/>
  <field name="perm_write" eval="True"/>
  <field name="perm_create" eval="False"/>
  <field name="perm_unlink" eval="False"/>
  <field name="groups" eval="[(4, ref('base.group_portal'))]"/>
  <field name="domain_force">[('id', '=', user.partner_id.id)]</field>
</record>

</odoo>
