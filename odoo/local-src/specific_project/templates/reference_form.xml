<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <template id="reference_form" name="Reference form">
    <t t-call="website.layout">
      <div id="wrap" class="opt_dark_grid_bg reference-form">
        <div class="container">
          <div class="center-block main-content-wrapper">
            <form action="" method="post" role="form" class="form form-horizontal" enctype="multipart/form-data">
              <h2>
                <t t-if="reference">Edit reference</t>
                <t t-if="not reference">Add reference</t>
              </h2>
              <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
              <!--
                TEMPLATE FOR A NEW FIELD!
                <div t-attf-class="form-group #{errors.get('AAA') and 'has-error' or ''} field-AAA">
                    <label class="col-sm-3 control-label" for="AAA">AAA</label>
                    <div class="col-sm-9">
                        <input type="text" id="AAA" name="AAA" class="form-control" t-att-value="AAA" />
                    </div>
                </div>
                 -->
              <div t-attf-class="form-group #{errors.get('name') and 'has-error' or ''} field-name">
                <label class="col-sm-3 control-label" for="name">Reference title*</label>
                <div class="col-sm-9">
                  <input type="text" id="name" name="name" class="form-control" t-att-value="name"/>
                </div>
              </div>
              <div t-attf-class="form-group #{errors.get('implementation_date') and 'has-error' or ''} field-implementation_date">
                <label class="col-sm-3 control-label" for="implementation_date">Implementation date</label>
                <div class="col-sm-9 date">
                  <div class="input-group">
                    <input name="implementation_date" id="implementation_date" class="form-control" type="text" data-date-format="YYYY-MM-DD" placeholder="YYYY-MM-DD" t-att-value="implementation_date"/>
                    <span class="input-group-addon">
                      <span class="fa fa-calendar"></span>
                    </span>
                  </div>
                </div>
              </div>
              <div t-attf-class="form-group #{errors.get('location') and 'has-error' or ''} field-location">
                <label class="col-sm-3 control-label" for="location">Location</label>
                <div class="col-sm-9">
                  <input type="text" id="location" name="location" class="form-control" t-att-value="location"/>
                </div>
              </div>
              <div t-attf-class="form-group #{errors.get('country_id') and 'has-error' or ''} field-country_id">
                <label class="col-sm-3 control-label" for="country_id">Country</label>
                <div class="col-sm-9">
                  <div class="styled-select">
                    <select name="country_id" class="form-control">
                      <option value="">Country...</option>
                      <t t-foreach="countries or []" t-as="country">
                        <option t-att-value="country.id" t-att-selected="country.id == country_id">
                            <t t-esc="country.name"/>
                        </option>
                      </t>
                    </select>
                  </div>
                </div>
              </div>
              <div t-attf-class="form-group #{errors.get('industry_ids') and 'has-error' or ''} field-industry_ids">
                <label class="col-sm-3 control-label" for="industry_ids">Industry</label>
                <div class="col-sm-9">
                  <input type="text" id="industry_ids" name="industry_ids" class="form-control js_select2_categories" t-attf-data-init-value="#{industry_ids}" value="industries"/>
                </div>
              </div>
              <div t-attf-class="form-group #{errors.get('expertise_ids') and 'has-error' or ''} field-expertise_ids">
                <label class="control-label col-sm-3" for="industry_ids">Expertise</label>
                <div class="col-sm-9">
                  <input type="text" name="expertise_ids" class="form-control js_select2_expertises" t-attf-data-init-value="#{expertise_ids}" value="expertises"/>
                  <p class="help-block">
                    Don't find your industry or expertise? Write us an email at
                    <a href="mailto:expertise@fluxdock.io?subject=new%20industry%20/%20expertise">expertise@fluxdock.io</a>
                  </p>
                </div>
              </div>
              <div t-attf-class="form-group #{errors.get('website_short_description') and 'has-error' or ''} field-website_short_description">
                <label class="control-label col-sm-3" for="website_short_description">Description*</label>
                <div class="col-sm-9">
                  <textarea class="form-control" name="website_short_description" t-esc="website_short_description"></textarea>
                </div>
              </div>
              <div class="form-group form-field mt8 field-image">
                <label class="col-sm-3 control-label" for="image">Image</label>
                <div class="col-sm-9">
                  <t t-call="theme_fluxdocs.imageupload_widget">
                    <t t-if="reference and reference.image">
                      <t t-set="image_preview_url" t-value="website.image_url(reference, 'image', '450x200')" />
                    </t>
                    <t t-set="image_preview_width" t-value="450" />
                  </t>
                  <t t-if="has_image">
                    <t t-set="prefix" t-value="'image'"/>
                    <div t-attf-id="#{prefix}_keepbox" class="keepbox text-center">
                      <div class="form-group">
                        <label class="checkbox inline" t-attf-for="#{prefix}_keepcheck_yes">
                          <input type="radio" t-attf-id="#{prefix}_keepcheck_yes" t-attf-name="#{prefix}_keepcheck" checked="1" value="yes"/>
                          keep submitted
                        </label>
                        <label class="checkbox inline" t-attf-for="#{prefix}_keepcheck_no">
                          <input type="radio" t-attf-id="#{prefix}_keepcheck_no" t-attf-name="#{prefix}_keepcheck" value="no"/>
                          replace submitted
                        </label>
                      </div>
                    </div>
                  </t>
                </div>
              </div>
              <div t-attf-class="form-group #{errors.get('video_url') and 'has-error' or ''} field-video_url ">
                <label class="control-label col-sm-3" for="video_url">Video_URL</label>
                <div class="col-sm-9">
                  <input type="text" id="video_url" name="video_url" class="form-control" t-att-value="video_url"/>
                </div>
              </div>
              <div t-attf-class="form-group #{errors.get('linked_partner_ids') and 'has-error' or ''} field-linked_partner_ids">
                <label class="col-sm-3 control-label" for="linked_partner_ids">Linked partners</label>
                <div class="col-sm-9">
                    <!-- a record rule makes sure that here
                    we can list only partners that are published and fluxdock members.
                    We just need to exclude ourselves with a custom domain -->
                    <input type="text" id="linked_partner_ids" name="linked_partner_ids"
                           class="form-control js_select2_m2m_widget"
                           t-attf-data-init-value="#{linked_partner_ids}" value="industries"
                           data-model="res.partner" data-display_name="name" data-fields='["name"]'
                           t-att-data-domain='"""[["id","!=",{}]]""".format(request.session.uid)'
                           />
                    <p class="help-block">Don't find your partner? Write us an email with the partner company name and email address at
                        <a href="mailto:newpartner@fluxdock.io?subject=new%20partner">newpartner@fluxdock.io</a> for inviting him.</p>
                </div>
              </div>
              <div class="form-group row">
                <p>* Required fields</p>
              </div>
              <div class="form-group mt32 controls">
                <div class="col-sm-9 col-sm-offset-3">
                  <a class="btn btn-warning" t-att-href="request.httprequest.referrer">Cancel</a>
                  <button type="submit" class="btn btn-primary">Submit</button>
                  <t t-if="reference">
                      <a class="btn btn-default btn-danger delete_reference ml32 pull-right"
                         t-attf-href="#{reference.website_url}/delete_confirm">Delete</a>
                  </t>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </t>
  </template>

</odoo>
