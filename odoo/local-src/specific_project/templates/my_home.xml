<?xml version="1.0" encoding="utf-8"?>
<odoo>

<template id="account" name="Fluxdock my/home: add references" inherit_id="specific_membership.my_home_content">
  <xpath expr="//div[@id='col-1']/t[@t-call][last()]" position="after">
        <t t-call="specific_project.reference_overview" />
  </xpath>
</template>


<template id="reference_overview" name="Fluxdock references overview">
    <div class="home_box">
        <h3 class="page-header">References</h3>
        <p>References are projects your company has realized.</p>
        <t t-set="references" t-value="request.env.user.references_ids" />
        <t t-if="not references">
            <p>You have currently registred no references on your account.</p>
        </t>
        <t t-if="references">
            <table class="table table-hover no-border o_my_proposal_table">
                <thead>
                </thead>
                <t t-foreach="references" t-as="item">
                    <tr t-att-class="'hidden to_hide' if item_index &gt; 3 else ''">
                        <td>
                            <a t-att-href="item.website_url"><b t-field="item.name"/></a>
                        </td>
                        <td>
                            <small t-if="not item.website_published" class="text-muted">not published</small>
                        </td>
                        <td>
                            <span t-field="item.create_date" class="text-muted" t-field-options='{"format": "d MMMM y"}'/>
                        </td>
                        <td>
                            <a t-att-href="item.cms_edit_url" class="text-muted">Edit</a>
                        </td>
                    </tr>
                </t>
                <tr t-att-class="'hidden' if len(references) &lt;= 4 else ''">
                    <td colspan="4"><a href="" class="o_my_show_more btn btn-xs btn-default"><span>Show more</span><span class="hidden">Show less</span></a></td>
                </tr>
            </table>
        </t>
        <div class="actions">
            <a t-attf-class="btn btn-dark btn-show-reference #{not partner.website_published and 'disabled'}"
               t-att-href="partner.website_published and (request.env['project.reference'].cms_search_url + '?only_my=on')" title="Show all references">
                Show all references
            </a>
            <a t-attf-class="btn btn-dark btn-add-reference #{not partner.website_published and 'disabled'}"
               t-att-href="partner.website_published and request.env['project.reference'].cms_add_url" title="Add a reference">
               Add a reference
            </a>
        </div>
    </div>
</template>

</odoo>
