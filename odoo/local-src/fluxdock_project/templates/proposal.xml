<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <template id="proposal_detail" name="Fluxdock proposal detail view">
    <t t-call="website.layout">
      <t t-set="is_anon" t-value="not request.session.uid"/>
      <!-- important to check for `is_anon` too because when you are anonymous user
  you are "Public User" indeed, so you could have a membership state (default to `free`)-->
      <t t-set="is_associate" t-value="not is_anon and request.env.user.is_associate"/>
      <t t-set="is_free_member" t-value="not is_anon and request.env.user.is_free"/>
      <t t-set="is_owner" t-value="main_object.create_uid.id == request.session.uid"/>
      <t t-set="can_view_details" t-value="is_associate or is_owner"/>

      <div class="opt_dark_bg proposal-detail" id="wrap">
        <t t-call="fluxdock_theme.mgmt_actions">
            <t t-set="object" t-value="main_object"/>
            <t t-set="show_add" t-value="False"/>
        </t>
        <div class="white_bg pt2">
          <div class="center-block main-content-wrapper" id="ref_content">
            <h1><t t-esc="main_object.name"/></h1>
            <div class="text-muted">
                <span t-field="main_object.create_date" t-field-options='{"widget": "date"}'/>
            </div>
            <p><b t-field="main_object.website_short_description"/></p>
            <div class="details border-tnb mb32 mt16 pt1 pb1">
              <t t-if="can_view_details">
                  <p t-field="main_object.website_description"/>
              </t>
              <div t-if="can_view_details">
                <div class="row">
                  <div class="col-md-3"><strong>Country:</strong>
                  </div>
                  <div class="col-md-9"><span t-field="main_object.country_id" />
                  </div>
                </div>
              </div>
              <div t-if="can_view_details">
                <div class="row">
                  <div class="col-md-3"><strong>Location:</strong>
                  </div>
                  <div class="col-md-9"><span t-field="main_object.location" />
                  </div>
                </div>
              </div>
              <div>
                <div class="row">
                  <div class="col-md-3"><strong>Duration:</strong>
                  </div>
                  <div class="col-md-9">
                    <span t-field="main_object.start_date"/>
                    -
                    <span t-field="main_object.stop_date"/>
                  </div>
                </div>
              </div>
              <t t-if="can_view_details and main_object.industry_ids">
                <div class="row">
                  <div class="col-md-3"><strong>Industry:</strong>
                  </div>
                  <div class="col-md-9">
                    <t t-foreach="main_object.industry_ids" t-as="one_tag">
                      <t t-esc="one_tag.name + ('' if one_tag_last else ', ')" />
                    </t>
                  </div>
                </div>
              </t>
              <t t-if="can_view_details and main_object.expertise_ids">
                <div class="row">
                  <div class="col-md-3"><strong>Expertise:</strong>
                  </div>
                  <div class="col-md-9">
                    <t t-foreach="main_object.expertise_ids" t-as="one_tag">
                      <t t-esc="one_tag.name + ('' if one_tag_last else ', ')" />
                    </t>
                  </div>
                </div>
              </t>
            </div>
          </div>
          <t t-set="owner_partner" t-value="main_object.sudo().create_uid.partner_id"/>
          <t t-set="owner_partner" t-value="owner_partner.parent_id if owner_partner.parent_id else owner_partner"/>
          <t t-if="owner_partner and can_view_details">
              <!-- TODO: make this a reusable template since is used also in member detail -->
            <section class="content detail-address proposal-address white_bg">
                <div class="content-wrap">
                  <h2 class="border-bottom">Contact</h2>
                  <div class="member-fields">
                    <span t-esc="owner_partner.name" /><br />
                    <t t-foreach="('contact_name', 'contact_email', 'contact_phone')"  t-as="fname">
                        <t t-if="main_object[fname]">
                            <span t-esc="main_object[fname]" /><br />
                        </t>
                    </t>
                    <span t-esc="owner_partner.street2" /><br />
                    <t t-if="owner_partner.country_id">
                      <span t-esc="owner_partner.country_id.name" /> -
                    </t>
                    <span t-esc="owner_partner.zip" /> <span t-esc="owner_partner.city" /><br />
                    <!-- <t t-if="owner_partner.phone">t
                      <t t-esc="owner_partner.phone" /><br />
                    </t>
                    <t t-if="owner_partner.fax">f
                      <t t-esc="owner_partner.fax" /><br />
                    </t> -->
                    <!--  TODO: obfuscate email to prevent SPAMming -->
                    <!-- <t t-if="owner_partner.email">
                      <a t-attf-href="mailto:{{ owner_partner.email }}"><t t-esc="owner_partner.email"/></a>
                      <br />
                    </t> -->
                    <t t-if="owner_partner.website">
                      <a t-att-href="owner_partner.website"><t t-esc="owner_partner.website"/></a>
                    </t>
                  </div>
                  <div class="member-social-media">
                    <a target="_blank" t-att-href="owner_partner.facebook" t-if="owner_partner.facebook" class="social-media facebook">
                      <i class="fa fa-facebook circled" aria-hidden="true"/>
                    </a>
                    <a target="_blank" t-att-href="owner_partner.twitter" t-if="owner_partner.twitter" class="social-media twitter">
                      <i class="fa fa-twitter circled" aria-hidden="true"></i>
                    </a>
                    <a target="_blank" t-attf-href="skype:#{owner_partner.skype}?userinfo" t-if="owner_partner.skype" class="social-media skype">
                      <i class="fa fa-skype circled" aria-hidden="true"></i>
                    </a>
                  </div>
                </div>
            </section>
          </t>

          <t t-if="not can_view_details">
            <t t-call="fluxdock_membership.membership_actions"/>
          </t>

          <!-- <div class="white_bg pt2 backto_actions">
            <div class="center-block main-content-wrapper text-center">
              <a class="btn btn-dark" t-att-href="TODO">
                <t t-if="filters == 'match'">Return to my account</t>
                <t t-if="filters != 'match'">Return to list</t>
              </a>
            </div>
          </div> -->
        </div>
      </div>
    </t>
  </template>


</odoo>
