<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <template id="listing" name="Fluxdock listing">
        <div class="listing">
            <t t-if="not listing_items">
                <t t-if="not no_results_template">
                    <div class="row list-item no-results text-muted">
                        <div class="col-md-12">
                            <h4 class="text-center">No result found.</h4>
                        </div>
                    </div>
                </t>
                <t t-if="no_results_template">
                    <t t-call="#{ no_results_template }" />
                </t>
            </t>
            <t t-foreach="listing_items" t-as="item">
                <div class="row list-item"
                     t-att-data-publish="handle_publish and (item.website_published and 'on' or 'off') or None">
                    <t t-set="detail_href" t-value="detail_url and detail_url.format(slug(item)) or item.website_url"/>
                    <t t-if="show_preview">
                        <div class="col-md-3 item-preview">
                            <a class="item-link"
                               t-att-href="detail_href">
                               <img class="img img-responsive center-block"
                                    t-att-src="website.image_url(item, 'image', '128x128')" />
                            </a>
                        </div>
                    </t>
                    <div t-attf-class="item-content #{show_preview and 'col-md-9' or 'col-md-12'}">
                        <div class="item-details">
                            <t t-if="show_create_date">
                                <div class="text-muted">
                                  <span t-field="item.create_date" t-field-options='{"format": "d MMMM y"}'/>
                                </div>
                            </t>
                            <t t-if="hide_item_url and item.create_uid.id != uid">
                                <a class="clickable hide_listing_item fa fa-eye-slash no-decoration pull-right"
                                   t-att-data-href="hide_item_url.format(slug(item))"
                                   title="Don't show again item"/>
                            </t>
                            <t t-if="show_published">
                                <span t-if="not item.website_published" class="label label-danger">not published</span>
                            </t>
                            <h3 class="item-heading">
                                <a t-att-href="detail_href">
                                    <strong t-field="item.display_name"/>
                                </a>
                            </h3>
                            <div class="item-description">
                                <span t-esc="website.truncate_text(item.website_short_description, length=200)"/>
                                <a class="read-more" t-att-href="detail_href">Read More
                                    <i class="fa fa-long-arrow-right"></i>
                                </a>
                            </div>
                            <t t-if="item_tags_template">
                                <t t-call="#{ item_tags_template }" />
                            </t>
                        </div>
                    </div>
                </div>
            </t>
        </div>

    </template>

    <template id="item_tags" name="Fluxdock item tags template">
        <t t-set="industries" t-value="item.category_id if item._name == 'res.partner' else item.industry_ids" />
        <t t-if="industries">
          <div class="flex flex-grid-fit item-tags industry">
              <div class="col col-pd-1 tag-label">
                  <strong>Industry:</strong>
              </div>
              <div class="col col-pd-1 tag-value">
                  <!-- TODO: get rid of this after migrating `category_id` to `industry_ids` on partner model -->
                  <t t-foreach="industries" t-as="one_tag">
                      <span t-esc="one_tag.name + ('' if one_tag_last else ', ')"/>
                  </t>
              </div>
          </div>
        </t>
        <t t-set="expertises" t-value="item.expertise_ids" />
        <t t-if="expertises">
            <div class="flex flex-grid-fit item-tags expertise">
                <div class="col col-pd-1 tag-label">
                    <strong>Expertise:</strong>
                </div>
                <div class="col col-pd-1 tag-value">
                    <t t-foreach="expertises" t-as="one_tag">
                        <span t-esc="one_tag.name + ('' if one_tag_last else ', ')"/>
                    </t>
                </div>
            </div>
        </t>
    </template>

</odoo>
