<?xml version="1.0" encoding="utf-8" ?>
<openerp>
	<data>

		<template id="submenu" name="Fluxdock submenu">
			<!-- barely copied from website and fixed "active" class -->
		    <li t-if="not submenu.child_id" t-att-class="
		        'active' if submenu.url and submenu.url != '/' and submenu.url in request.httprequest.path else None">
		        <a t-att-href="(website.menu_id.child_id[0] == submenu) and '/' or submenu.url" t-ignore="true" t-att-target="'_blank' if submenu.new_window else None">
		            <span t-field="submenu.name"/>
		        </a>
		    </li>
		</template>


		<template id="personal_menu_content" name="Fluxdock personal menu content">
			<li id="myhome">
				<a href="/my/home" role="menuitem"><i class="fa fa-user" /> My home</a>
			</li>
			<li id="myprofile">
				<a t-att-href="request.env.user.partner_id.website_url" role="menuitem"><i class="fa fa-user" /> My public profile</a>
			</li>
			<li role="separator" class="divider"></li>
			<li id="add_reference">
				<a t-att-href="request.env['project.reference'].cms_add_url" role="menuitem"><i class="fa fa-plus" /> Add reference</a>
			</li>
			<li id="add_proposal">
				<a t-att-href="request.env['project.proposal'].cms_add_url" role="menuitem"><i class="fa fa-plus" /> Add proposal</a>
			</li>
			<li role="separator" class="divider"></li>
			<li id="reset_pwd">
				<a role="menuitem" t-attf-href="/web/reset_password?login=#{request.env.user.login}"><i class="fa fa-lock" /> Change password</a>
			</li>
			<li role="separator" class="divider"></li>
			<li id="logout">
				<a href="/web/session/logout?redirect=/" role="menuitem"><i class="fa fa-sign-out" /> Logout</a>
			</li>
		</template>


		<template id="service_menu" name="Fluxdock service menu">
			<!-- Logged in -->
			<ul class="service-menu" t-ignore="true" t-if="request.session.uid">
				<li id="user-menu">
					<div class="dropdown">
						<a id="usermenu" data-target="#" href="#" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
							<i class="fa fa-user" />
							<span class="username" t-field="request.env.user.name" />
							<span class="caret"></span>
						</a>
						<ul class="dropdown-menu" aria-labelledby="usermenu">
							<t t-call="theme_fluxdocs.personal_menu_content" />
						</ul>
					</div>
				</li>
				<li>
					<t t-call="website.language_selector"/>
				</li>
			</ul>

			<!-- Anonymous -->
			<ul class="service-menu" t-ignore="true" t-if="not request.session.uid">
				<li>
					<a href="/web/login?redirect=/my/home">Login</a>
				</li>
				<li>
					<a href="/web/presignup">Sign Up</a>
				</li>
				<li>
					<t t-call="website.language_selector"/>
				</li>
			</ul>
		</template>

		<!-- Customize header -->odoo/src/addons/website_crm_claim/website_claim_view.xml
		<template id="custom_header" inherit_id="website.layout" name="Fluxdock custom header">

			<xpath expr="//div[@id='wrapwrap']/header" position="replace">
				<header id="my_header">
					<div class="fluxdock-topbar">

						<a href="/" class="navbar-brand">
							<!-- Needed for other modules to put their stuff in it -->
						</a>

						<a href="/" class="fluxdock-header-logo">
							<div class="fluxdock-logo"></div>
							<div class="fluxdock-title"></div>
						</a>
						<ul id="top_menu">
							<li></li>
							<!-- Needed for other modules to put their stuff in it -->
						</ul>

						<ul class="main-menu">
							<t t-foreach="website.menu_id.child_id" t-as="submenu">
								<t t-call="theme_fluxdocs.submenu"/>
							</t>
						</ul>

						<t t-call="theme_fluxdocs.service_menu"/>

						<ul style="display:none!important">
							<li id="o_logout">
								<!-- fake hook for other website modules that want this
										 to inject their stuff, but we don't want them to show anything here -->
							</li>
						</ul>

						<!-- Hamburger -->
						<div id="mobile-menu-trigger">
							<i class="fa fa-bars"></i>
						</div>
					</div>
				</header>
			</xpath>

		</template>

		<!-- Add mobile menu -->
	<template id="mobile-menu" inherit_id="website.layout" name="Fluxdock Mobile Menu">

	<!-- ADD ID -->
	<xpath expr="//div[@id='wrapwrap']" position="before">
		<nav class="mobile-menu">
			<ul class="main-menu">
				<t t-foreach="website.menu_id.child_id" t-as="submenu">
					<t t-call="theme_fluxdocs.submenu"/>
				</t>
			</ul>

			<!-- Logged in -->
			<ul class="service-menu" t-ignore="true" t-if="request.session.uid">
				<t t-call="theme_fluxdocs.personal_menu_content" />
			</ul>

			<!-- Anonymous -->
			<ul class="service-menu" t-ignore="true" t-if="not request.session.uid">
				<li>
					<a href="/web/login?redirect=/my/home">Login</a>
				</li>
				<li>
					<a href="/web/presignup">Sign Up</a>
				</li>
			</ul>

			<t t-call="website.language_selector"/>

			<div class="social-media">
				<a class="facebook" href="https://www.facebook.com/fluxdock/" target="_blank"></a>
				<a class="twitter" href="https://twitter.com/fluxdock" target="_blank"></a>
				<a class="mail" href="mailto:info@fluxdock.io"></a>
			</div>

		</nav>
	</xpath>

</template>


		<!-- Customize footer -->
		<template id="fluxdock_footer" inherit_id="website.layout" name="Fluxdock Footer">

			<!-- ADD ID -->
			<xpath expr="//div[@id='wrapwrap']/footer" position="attributes">
				<attribute name="id">my_footer</attribute>
			</xpath>

		</template>

		<template id="website.layout_footer_copyright" inherit_id="website.layout" name="Footer Copyright">

		    <xpath expr="//footer" position="inside">
		    	<div class="footer-row clearfix">
			        <div class="footer-logo">
				    	<a href="/">
					    	<img src="/theme_fluxdocs/static/img/fluxdock_logo_f.png"></img>
				    	</a>
			    	</div>

					<div class="footer-links clearfix">
						<div class="footer-col">
							<h4>Subtitle</h4>
							<p>
								<a href="/">Homepage</a>
							</p>
						</div>
						<div class="footer-col">
							<h4>Subtitle 2</h4>
							<p>
								...
							</p>
						</div>
						<div class="footer-col">
							<h4>Subtitle 3</h4>
							<p>
								...
							</p>
						</div>
					</div>
			        <div class="sponsors">
				    	<div class="sponsor sponsor-iart">
							<a href="http://www.iart.ch" target="_blank">
								<img src="/theme_fluxdocs/static/img/footer-logos/iart.png"></img>
							</a>
						</div>
				    	<div class="sponsor sponsor-mengagement">
							<a href="http://www.engagement-migros.ch" target="_blank">
								<img src="/theme_fluxdocs/static/img/footer-logos/mengagement.png"></img>
							</a>
						</div>
				    	<div class="sponsor sponsor-cms">
							<a href="http://www.cms-basel.ch" target="_blank">
								<img src="/theme_fluxdocs/static/img/footer-logos/cms.png"></img>
							</a>
						</div>
						<div class="sponsor sponsor-c2c">
							<a href="http://www.camptocamp.com" target="_blank">
								<img src="/theme_fluxdocs/static/img/footer-logos/c2c.png"></img>
							</a>
						</div>
			    	</div>
		    	</div>
		    	<div class="copyright">
		    		copyright Â© 2016
		    	</div>
		    </xpath>
		</template>


		<!-- Customize News List -->
		<template id="fluxdock_news_list" inherit_id="website_blog.blog_post_short" name="Fluxdock News List">

			<xpath expr="//div[@id='main_column']" position="replace">
				<div t-ignore="True" id="main_column">

                <div t-if="not blog_posts" class="blog-list no-blogs">
                  <p class="css_editable_hidden">
                    <h1>No blog post yet.</h1>
                  </p>
                  <p groups="base.group_website_designer">
                    Click on "Content" on the top menu to write your first blog post.
                  </p>
                </div>

                <div t-foreach="blog_posts" t-as="blog_post" class="blog-list">
                	<div class="blog-date" t-field="blog_post.create_date" t-field-options='{"format": "dd MMMM yyyy"}'/>
                    <a t-attf-href="/blog/#{ slug(blog_post.blog_id) }/post/#{ slug(blog_post) }">
                        <h2 t-field="blog_post.name" class="blog-name"><t t-if="not blog_post.name">Untitled Post</t></h2>
                    </a>
                    <div class="text-muted">
                        <h4 t-field="blog_post.subtitle" class="blog-subtitle"></h4>
                        <div name='blog_post_data' class='mb0'>

                        	<!-- Filled by other template -->

                        	<span t-if="not blog_post.website_published" class="label label-danger">not published</span>
                        </div>
                    </div>
                    <a class="read-more" t-attf-href="/blog/#{ slug(blog_post.blog_id) }/post/#{ slug(blog_post) }">
                    	Read more <i class="fa fa-long-arrow-right"></i>
                    </a>
                </div>
              </div>
			</xpath>

		</template>


	</data>
</openerp>
